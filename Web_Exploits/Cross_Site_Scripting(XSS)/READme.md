# Cross Site Scripting
## @Author : M3tr1c_r00t
### Overview
Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites

Cross-site scripting works by manipulating a vulnerable web site so that it returns malicious JavaScript to users. When the malicious code executes inside a victim’s browser, the attacker can fully compromise their interaction with the application.

It’s long been common practice to use the alert() function for this purpose because it’s short, harmless, and pretty hard to miss when it’s successfully called. In fact, you solve the majority of our XSS labs by invoking alert() in a simulated victim’s browser.

Unfortunately, there’s a slight hitch if you use Chrome. From version 92 onward (July 20th, 2021), cross-origin iframes are prevented from calling alert(). As these are used to construct some of the more advanced XSS attacks, you’ll sometimes need to use an alternative PoC payload. In this scenario, we recommend the print() function. If you’re interested in learning more about this change and why we like print(), check out our blog post on the subject.

### Types of XSS Attacks
- Reflected XSS
- Stored XSS
- DOM-based XSS
- Blind XSS


#### 1). Reflected XSS
This is where the injected script is reflected off the web server, such as in an error message, search result, or any other response that includes some or all of the input sent to the server as part of the request.
It is the simplest variety of cross-site scripting. 

It arises when an application receives data in an HTTP request and includes that data within the immediate response in an unsafe way.

Here is a simple example of a reflected XSS vulnerability:
```
https://insecure-website.com/status?message=All+is+well.
<p>Status: All is well.</p>

```
The application doesn’t perform any other processing of the data, so an attacker can easily construct an attack like this:

```
https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>
<p>Status: <script>/* Bad stuff here... */</script></p>

```
#### 2). Stored XSS
Is also known as persistent or second-order XSS

This arises when an application receives data from an untrusted source and includes that data within its later HTTP responses in an unsafe way.

The data in question might be submitted to the application via HTTP requests; for example, comments on a blog post, user nicknames in a chat room, or contact details on a customer order. 

In other cases, the data might arrive from other untrusted sources; for example, a webmail application displaying messages received over SMTP, a marketing application displaying social media posts, or a network monitoring application displaying packet data from network traffic.


Here is a simple example of a stored XSS vulnerability. 

A message board application lets users submit messages, which are displayed to other users:

```
<p>Hello, this is my message!</p>
```

Since the application doesn’t perform any other processing, we can execute code:

```
<p><script>/* Bad stuff here... */</script></p>
```

#### 3). DOM XSS
This arises when an application contains some client-side JavaScript that processes data from an untrusted source in an unsafe way, usually by writing the data back to the DOM.

In the following example, an application uses some JavaScript to read the value from an input field and write that value to an element within the HTML:
```
Var search = document.getElementById(‘search’).value;
Var results = document.getElementById(‘results’);
Results.innerHTML = ‘You searched for: ‘ + search;
```

If the we can control the value of the input field, we can make our own payload/script to execute:
```
You searched for: <img src=1 onerror=’/* Bad stuff here... */’>
```

#### 4). Blind XSS
Is a form of persistent XSS.

This occurs when the attacker’s payload saved on the server and reflected back to the victim from the backend application.

For example in forms and message panels.

In this case, the payload in the form will be exxecuted when being looked at and even at times when being submitted onto the server.







