# Sqli
## @Author : M3tr1c_r00t
### Union Clause
Is used to combine results from multiple SELECT statements. With this, we will be able to SELECT and dump data from all across the DBMS, from multiple tables and databases. 
```
mysql> SELECT * FROM ports UNION SELECT * FROM ships;
```
Some of the rows belong to the ports table while others belong to the ships table.

__Note:__ The data types of the selected columns on all positions should be the same.
### Union on Same No of Columns

A UNION statement can only operate on SELECT statements with an equal number of columns.

If we attempt to UNION two queries that have results with a different number of columns, we get an error.
```
mysql> SELECT city FROM ports UNION SELECT * FROM ships;
ERROR 1222 (21000): The used SELECT statements have a different number of columns
```

Once we have two queries that return the same number of columns, we can use the UNION operator to extract data from other tables and databases.
```
SELECT * FROM products WHERE product_id = ‘user_input’
```
We can inject a UNION query into the input, such that rows from another table are returned:
```
SELECT * from products where product_id = ‘1’ UNION SELECT username, password from passwords—‘
```
This would return username and password entries from the passwords table, assuming the products table has two columns.

### Un-even Columns
Suppose we only had one column. In that case, we want to SELECT, we can put junk data for the remaining required columns so that the total number of columns we are UNIONing with remains the same as the original query.

We can use any string as our junk data, and the query will return the string as its output for that column. 

If we UNION with the string “junk”, the SELECT query would be SELECT “junk” from passwords, which will always return junk. 

We can also use numbers. For example, the query SELECT 1 from passwords will always return 1 as the output.

__Note:__ When filling other columns with junk data, we must ensure that the data type matches the columns data type, otherwise the query will return an error.

__**Tip:**__ For advanced SQL injection, we may want to simply use 'NULL' to fill other columns, as 'NULL' fits all data types.

So we have to UNION with two columns. If we only wanted to get one column ‘e.g. username’, we have to do username, 2, such that we have the same number of columns:
```
SELECT * from products where product_id = ‘1’ UNION SELECT username, 2 from passwords
```
If we had more columns in the table of the original query, we have to add more numbers to create the remaining required columns. 
```
UNION SELECT username, 2, 3, 4 from passwords—‘
```
This would return:
```
mysql> SELECT * from products where product_id UNION SELECT username, 2, 3, 4 from passwords—‘

+-----------+-----------+-----------+-----------+
| product_1 | product_2 | product_3 | product_4 |
+-----------+-----------+-----------+-----------+
|   admin   |    2      |    3      |    4      |
+-----------+-----------+-----------+-----------+
```
As we can see, our wanted output of the ‘UNION SELECT username from passwords’ query is found at the first column of the second row, while the numbers filled the remaining columns.

### Union Injections
in a search parameter, we can try to put a single quote(') and see if we get an error.
#### Detecting Number of Columns
we can use
- ORDER BY
- UNION

#### ORDER BY
We have to inject a query that sorts the results by a column we specified, 'i.e., column 1, column 2, and so on', until we get an error saying the column specified does not exist.

, we can start with order by 1, sort by the first column, and succeed, as the table must have at least one column. Then we will do order by 2 and then order by 3 until we reach a number that returns an error, or the page does not show any output, which means that this column number does not exist. The final successful column we successfully sorted by gives us the total number of columns.

If we failed at order by 4, this means the table has three columns, which is the number of columns we were able to sort by successfully. 
```
' order by 1-- -
```

#### Using UNION
WE can use a Union injection with a different number of columns until we successfully get the results back.
 We can start by injecting a 3 column UNION query:
```
' UNION select 1,2,3-- -
```

While a query may return multiple columns, the web application may only display some of them.
So, if we inject our query in a column that is not printed on the page, we will not get its output.

 we can use the @@version SQL query as a test and place it in the second column instead of the number 2:
 ```
 ' UNION select 1,@@version,3,4-- -
 ```
 
 
 
 
 


## My socials:
<br>@ twitter: https://twitter.com/M3tr1c_root
<br>@ instagram: https://instagram.com/m3tr1c_r00t/
